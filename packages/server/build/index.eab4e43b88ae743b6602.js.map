{"version":3,"file":"index.8d9675c6b3f8c4b72977.hot-update.js","sources":["/Users/austinreynolds/Documents/MOD/chf-rcomm/packages/client/src/modules/common/schema/adminProductsQuery.js"],"sourcesContent":["import { graphql } from 'react-apollo';\nimport ADMIN_PRODUCTS_QUERY from '../graphql/SFY/sfyAdminProductsQuery.graphql';\n\nexport default (queryString = ADMIN_PRODUCTS_QUERY) =>\n  graphql(queryString, {\n    options: () => {\n      return { variables: { [`first`]: 250 } };\n    },\n    props: ({ data }) => {\n      const { productsLoading, error, sfy_shop, fetchMore, variables } = data;\n      console.log('DATA:::', data);\n      let currEndCursor, hasNextPage, hasPreviousPage;\n      if (!productsLoading && sfy_shop) {\n        const { products } = sfy_shop;\n        //console.log('products', products);\n        if (products.edges.length > 0) currEndCursor = products.edges[products.edges.length - 1].cursor;\n        hasNextPage = products.pageInfo.hasNextPage;\n        hasPreviousPage = products.pageInfo.hasPreviousPage;\n      }\n      const loadMore = (first = 250, after = currEndCursor) => {\n        const updatedVars = { ...variables, after, first };\n        return fetchMore({\n          variables: updatedVars,\n          updateQuery: (prevResult, { fetchMoreResult }) => {\n            if (fetchMoreResult.sfy_shop.products.edges.length === 0) return prevResult;\n            const updatedResult = JSON.parse(JSON.stringify(prevResult));\n            updatedResult.sfy_shop.products.edges = [\n              ...prevResult.sfy_shop.products.edges,\n              ...fetchMoreResult.sfy_shop.products.edges\n            ];\n            updatedResult.sfy_shop.products.pageInfo = fetchMoreResult.sfy_shop.products.pageInfo;\n            //console.log('udpatedres', updatedResult);\n            return updatedResult;\n          }\n        });\n      };\n      if (error) throw new Error(`Error in Admin Products Query: ${error}`);\n      if (productsLoading || !sfy_shop) return { productsLoading, sfy_shop };\n      if (!productsLoading && sfy_shop) {\n        console.log('PRODUCTS LOADING:', productsLoading);\n        return {\n          productsLoading,\n          sfy_shop,\n          currEndCursor,\n          hasNextPage,\n          hasPreviousPage,\n          loadMore\n        };\n      }\n    }\n  });\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAIA;AACA;AACA;AACA;AAZA;AAcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AACA;AA7CA;AADA;;;;A","sourceRoot":""}