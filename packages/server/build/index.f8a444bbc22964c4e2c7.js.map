{"version":3,"file":"index.30cbf5a7968a6668a63e.hot-update.js","sources":["/Users/austinreynolds/Documents/MOD/chf-rcomm/packages/client/src/modules/admin/containers/Dashboard.jsx"],"sourcesContent":["/*eslint-disable no-unused-vars*/\nimport React from 'react';\nimport { graphql, compose } from 'react-apollo';\n\nimport AdminView from '../components/AdminView';\nimport PAGES_QUERY from '../graphql/PagesQuery.graphql';\nimport UPLOAD_CONTENT from '../graphql/UploadContent.graphql';\nimport SIMPLE_PAGE_QUERY from '../graphql/SimplePageQuery.graphql';\nimport DEALERS_QUERY from '../graphql/Dealers.graphql';\nimport DEALER_BY_HANDLE_QUERY from '../graphql/DealerQuery.graphql';\nimport UPDATE_DEALER from '../graphql/UpdateDealer.graphql';\n\nclass Admin extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      images: new Map()\n    };\n  }\n  imageToState = images => {\n    this.setState({\n      images\n    });\n  };\n  save = (page_id, content) => {\n    // console.log('THIS.PROPS::', this.props);\n    this.props.uploadContent(9, [{}]);\n  };\n  render() {\n    console.log('The props::::', this.props);\n    return <AdminView {...this.props} save={this.save} />;\n  }\n}\nAdmin.defaultProps = {\n  images: []\n};\nconst AdminWithApollo = compose(\n  graphql(PAGES_QUERY, {\n    props: ({ data }) => {\n      const { pages, loading: loadingPages, error } = data;\n      console.log('pages', pages);\n      if (loadingPages && !error) {\n        return { loadingPages, pages: null };\n      } else {\n        return { pages, loadingPages };\n      }\n    }\n  }),\n  graphql(UPLOAD_CONTENT, {\n    props: ({ mutate }) => ({\n      uploadContent: async ({ page_id, content }) => {\n        // console.log('PAGE ID::', page_id);\n        // console.log('content::', content);\n        const {\n          data: { uploadPageContent }\n        } = await mutate({ variables: { pageContent: { page_id: page_id, content } } });\n        console.log('RETURN DATA::: ', uploadPageContent);\n        return uploadPageContent;\n      }\n    })\n  }),\n  graphql(DEALER_BY_HANDLE_QUERY, {\n    options: props => {\n      return { variables: { handle: ' ' } };\n    },\n    props: ({ data }) => {\n      console.log('data', data);\n      return { ...data };\n    }\n  }),\n  graphql(SIMPLE_PAGE_QUERY, {\n    options: () => {\n      return { variables: { pageTitle: 'Locations' } };\n    },\n    props: ({ data }) => {\n      console.log('Locations Page data', data);\n      const { page, loading: loadingPage, error } = data;\n      if (loadingPage && !error) {\n        return { loadingPage, page: null };\n      } else {\n        return { page, loadingPage };\n      }\n    }\n  }),\n  graphql(DEALERS_QUERY, {\n    options: () => ({\n      variables: { first: 12, after: 0 }\n    }),\n    props: ({ data }) => {\n      console.log('DATA:::', data);\n      const { loading, error, dealers } = data;\n      if (error) {\n        console.log('DEALERS ERROR:::', error);\n        return { dealersError: error };\n      }\n      if (loading) {\n        return { loadingDealers: loading };\n      }\n      if (!loading && !error) {\n        return { loadingDealers: loading, dealers };\n      }\n    }\n  }),\n  graphql(UPDATE_DEALER, {\n    props: ({ mutate }) => ({\n      updateDealer: async dealer => {\n        try {\n          const {\n            data: { updateDealer }\n          } = await mutate({\n            variables: { dealer }\n          });\n          console.log('UPDATED::', updateDealer);\n          return updateDealer;\n        } catch (e) {\n          console.log('ERROR UPDATING:', e);\n        }\n      }\n    }),\n    options: {\n      update: (proxy, { data: { updateDealer } }) => {\n        try {\n          // console.log('UPDATE DEALER::', updateDealer);\n          // console.log('OTHER PROXY READ::', other);\n          const dealer = proxy.readQuery({ query: DEALER_BY_HANDLE_QUERY, variables: { handle: ' ' } });\n          console.log('UPDATE DEALER:', dealer);\n          proxy.writeQuery({\n            query: DEALER_BY_HANDLE_QUERY,\n            data: { dealerByHandle: Object.assign({}, updateDealer) }\n          });\n          const data = proxy.readQuery({ query: DEALERS_QUERY, variables: { first: 12, after: 0 } });\n          // console.log('DATA::', data);\n          // const _edges = data.dealers.edges;\n          // const count = data.dealers.dealers_count;\n          // const newCount = data.\n          // proxy.writeQuery({\n          //   query: DEALERS_QUERY,\n          //   data: { dealers: { dealers_count: data.dealers.edges: [...data.dealers.edges, { node: updateDealer, cursor: 0 }] } }\n          // });\n          // console.log('Data::: on update::??', data);\n        } catch (e) {\n          console.log('EEE', e);\n          // const data = proxy.writeQuery({ query: })\n        }\n      }\n    }\n  })\n)(Admin);\n\nexport default AdminWithApollo;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA;AAAA;AACA;AADA;AACA;AADA;AAOA;AACA;AADA;AAGA;AACA;AAXA;AAYA;AACA;AACA;AACA;AAbA;AACA;AADA;AAFA;AAKA;AACA;;;AASA;AACA;AACA;AACA;;;;AAnBA;AACA;AAoBA;AACA;AADA;AAGA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAYA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAIA;AACA;AACA;AANA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AADA;AAAA;AADA;AAcA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAPA;AAUA;AACA;AACA;AACA;AAAA;AACA;AAAA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAZA;AAeA;AAAA;AACA;AADA;AAAA;AAGA;AAAA;AACA;AAAA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjBA;AAoBA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AADA;AACA;AALA;AAAA;AAGA;AACA;AAGA;AAPA;AACA;AADA;AAAA;AAAA;AACA;AASA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AADA;AAAA;AAeA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;AAhBA;AACA;AA6CA;;;;A","sourceRoot":""}